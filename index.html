<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My BALLB Notes</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
        }

        .hero-gradient {
            background: linear-gradient(135deg, #1f2937, #4b5563);
        }

        .card {
            background-color: #ffffff;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .transition-all {
            transition-property: all;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 150ms;
        }

        .page-section {
            display: none;
        }
    </style>
</head>
<body class="text-gray-800">

    <script type="module">
        import { initializeFirebase, db, APP_ID } from './firebase-config.js';
        import { onSnapshot, collection, query } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // ---- UI Management and Navigation ----
        const pageSections = document.querySelectorAll('.page-section');
        const navLinks = document.querySelectorAll('nav a');

        /**
         * Shows a specific page section and hides all others.
         * @param {string} pageId The ID of the page section to show.
         */
        function showPage(pageId) {
            pageSections.forEach(section => {
                if (section.id === pageId) {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });
            navLinks.forEach(link => {
                if (link.dataset.page === pageId) {
                    link.classList.add('font-bold', 'text-white');
                    link.classList.remove('hover:text-gray-300');
                } else {
                    link.classList.remove('font-bold', 'text-white');
                    link.classList.add('hover:text-gray-300');
                }
            });
        }
        window.showPage = showPage;

        // ---- Firebase Data Operations ----

        /**
         * Fetches and displays public notes from Firestore.
         */
        function fetchPublicNotes() {
            if (!db) return;
            const notesList = document.getElementById('notes-list');
            notesList.innerHTML = '<p class="text-center text-gray-500">Loading notes...</p>';

            const notesQuery = query(collection(db, `artifacts/${APP_ID}/public/data/notes`));
            onSnapshot(notesQuery, (querySnapshot) => {
                notesList.innerHTML = '';
                if (querySnapshot.empty) {
                    notesList.innerHTML = '<p class="text-center text-gray-500">No notes available yet.</p>';
                    return;
                }
                querySnapshot.forEach((doc) => {
                    const note = doc.data();
                    const noteElement = document.createElement('div');
                    noteElement.className = 'card p-6 mb-4';
                    noteElement.innerHTML = `
                        <h3 class="text-xl font-bold text-gray-900 mb-2">${note.title}</h3>
                        <p class="text-gray-600 mb-4">${note.description}</p>
                        <a href="${note.link}" target="_blank" class="text-blue-600 font-semibold hover:underline">Download/View Notes <i class="fas fa-external-link-alt ml-1"></i></a>
                    `;
                    notesList.appendChild(noteElement);
                });
            }, (error) => {
                console.error("Error fetching public notes:", error);
                notesList.innerHTML = '<p class="text-center text-red-500">Error loading notes.</p>';
            });
        }

        /**
         * Fetches and displays public updates from Firestore.
         */
        function fetchPublicUpdates() {
            if (!db) return;
            const updatesList = document.getElementById('updates-list');
            updatesList.innerHTML = '<p class="text-center text-gray-500">Loading updates...</p>';

            const updatesQuery = query(collection(db, `artifacts/${APP_ID}/public/data/updates`));
            onSnapshot(updatesQuery, (querySnapshot) => {
                updatesList.innerHTML = '';
                if (querySnapshot.empty) {
                    updatesList.innerHTML = '<p class="text-center text-gray-500">No updates available yet.</p>';
                    return;
                }
                querySnapshot.forEach((doc) => {
                    const update = doc.data();
                    const updateElement = document.createElement('div');
                    updateElement.className = 'card p-6 mb-4';
                    updateElement.innerHTML = `
                        <h3 class="text-xl font-bold text-gray-900 mb-2">${update.title}</h3>
                        <p class="text-gray-600">${update.description}</p>
                    `;
                    updatesList.appendChild(updateElement);
                });
            }, (error) => {
                console.error("Error fetching public updates:", error);
                updatesList.innerHTML = '<p class="text-center text-red-500">Error loading updates.</p>';
            });
        }

        window.onload = async () => {
            initializeFirebase();
            fetchPublicNotes();
            fetchPublicUpdates();
        };
    </script>

    <!-- Header & Navigation -->
    <header class="bg-gray-800 text-gray-300 shadow-lg sticky top-0 z-40">
        <div class="container mx-auto flex flex-col md:flex-row items-center justify-between p-6">
            <div class="flex items-center space-x-2 mb-4 md:mb-0">
                <i class="fas fa-scale-balanced text-4xl text-white"></i>
                <h1 class="text-3xl font-bold text-white tracking-wide">My BALLB Notes</h1>
            </div>
            <nav>
                <ul class="flex items-center space-x-6">
                    <li><a href="#" onclick="showPage('home')" data-page="home" class="transition-all hover:text-gray-300 font-bold text-white">Home</a></li>
                    <li><a href="#" onclick="showPage('notes-page')" data-page="notes-page" class="transition-all hover:text-gray-300">Notes</a></li>
                    <li><a href="#" onclick="showPage('updates-page')" data-page="updates-page" class="transition-all hover:text-gray-300">Updates</a></li>
                    <li><a href="#" onclick="showPage('qp-page')" data-page="qp-page" class="transition-all hover:text-gray-300">Q. Papers</a></li>
                    <li><a href="admin.html" class="transition-all hover:text-gray-300">Admin Login</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content Area - All sections are loaded here -->
    <main class="container mx-auto py-12 px-4 md:px-0">

        <!-- Home Page Section -->
        <section id="home" class="page-section" style="display: block;">
            <div class="hero-gradient text-white text-center p-16 md:p-24 rounded-2xl shadow-lg">
                <h2 class="text-4xl md:text-6xl font-extrabold mb-4 animate-fade-in-up">Your Legal Study Hub</h2>
                <p class="text-lg md:text-2xl mb-8 opacity-90 animate-fade-in">Free and accessible resources for law students and aspiring lawyers.</p>
                <a href="#" onclick="showPage('notes-page')" class="inline-block bg-blue-500 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-blue-600 transition-all transform hover:scale-105">
                    Explore Notes <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>

            <div class="grid md:grid-cols-3 gap-8 mt-16 text-center">
                <div class="card p-8">
                    <i class="fas fa-file-alt text-5xl text-blue-500 mb-4"></i>
                    <h3 class="text-xl font-bold mb-2">Free Law Notes</h3>
                    <p class="text-gray-600">Access well-researched, semester-wise notes for all your subjects.</p>
                </div>
                <div class="card p-8">
                    <i class="fas fa-newspaper text-5xl text-purple-500 mb-4"></i>
                    <h3 class="text-xl font-bold mb-2">Latest Updates</h3>
                    <p class="text-gray-600">Stay informed with the latest legal news and exam notifications.</p>
                </div>
                <div class="card p-8">
                    <i class="fas fa-clipboard-list text-5xl text-red-500 mb-4"></i>
                    <h3 class="text-xl font-bold mb-2">Question Papers</h3>
                    <p class="text-gray-600">Practice with a comprehensive collection of previous year's question papers.</p>
                </div>
            </div>
        </section>

        <!-- Notes Page Section -->
        <section id="notes-page" class="page-section">
            <h2 class="text-4xl font-bold text-center mb-8">Law Notes</h2>
            <div id="notes-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Notes will be dynamically loaded here -->
            </div>
        </section>

        <!-- Updates Page Section -->
        <section id="updates-page" class="page-section">
            <h2 class="text-4xl font-bold text-center mb-8">Latest Updates</h2>
            <div id="updates-list" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Updates will be dynamically loaded here -->
            </div>
        </section>

        <!-- Question Papers Page Section -->
        <section id="qp-page" class="page-section">
            <h2 class="text-4xl font-bold text-center mb-8">Previous Year Question Papers</h2>
            <div class="card p-8 text-center">
                <p class="text-xl text-gray-600">
                    This section will be updated with previous year's question papers. Stay tuned!
                </p>
                <div class="mt-4">
                    <i class="fas fa-tools text-6xl text-gray-400"></i>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-400 py-8 mt-12">
        <div class="container mx-auto text-center">
            <p>&copy; 2024 My BALLB Notes. All Rights Reserved.</p>
            <div class="flex justify-center space-x-4 mt-4 text-2xl">
                <a href="#" class="hover:text-white transition-all"><i class="fab fa-twitter"></i></a>
                <a href="#" class="hover:text-white transition-all"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="hover:text-white transition-all"><i class="fab fa-linkedin-in"></i></a>
            </div>
        </div>
    </footer>
</body>
</html>
